package Y1;

import E1.AbstractC0301c;
import E1.AbstractC0304f;
import E1.B;
import E1.C0305g;
import E1.I;
import E1.InterfaceC0314p;
import E1.InterfaceC0315q;
import E1.J;
import E1.N;
import E1.O;
import Y1.a;
import Z0.C0841m;
import Z0.q;
import Z0.z;
import android.util.Pair;
import android.util.SparseArray;
import b2.s;
import c1.AbstractC1117K;
import c1.AbstractC1119a;
import c1.AbstractC1133o;
import c1.C1111E;
import c1.C1144z;
import java.util.ArrayDeque;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import java.util.UUID;
import kotlin.io.ConstantsKt;
import kotlin.jvm.internal.IntCompanionObject;
import kotlin.jvm.internal.LongCompanionObject;

/* loaded from: /home/brian-terer/Downloads/BitePal/main_apk/classes.dex */
public class h implements InterfaceC0314p {

    /* renamed from: K, reason: collision with root package name */
    public static final E1.u f6375K = new E1.u() { // from class: Y1.f
        @Override // E1.u
        public final InterfaceC0314p[] c() {
            return h.b();
        }
    };

    /* renamed from: L, reason: collision with root package name */
    public static final byte[] f6376L = {-94, 57, 79, 82, 90, -101, 79, 20, -94, 68, 108, 66, 124, 100, -115, -12};

    /* renamed from: M, reason: collision with root package name */
    public static final Z0.q f6377M = new q.b().o0("application/x-emsg").K();

    /* renamed from: A, reason: collision with root package name */
    public long f6378A;

    /* renamed from: B, reason: collision with root package name */
    public b f6379B;

    /* renamed from: C, reason: collision with root package name */
    public int f6380C;

    /* renamed from: D, reason: collision with root package name */
    public int f6381D;

    /* renamed from: E, reason: collision with root package name */
    public int f6382E;

    /* renamed from: F, reason: collision with root package name */
    public boolean f6383F;

    /* renamed from: G, reason: collision with root package name */
    public E1.r f6384G;

    /* renamed from: H, reason: collision with root package name */
    public O[] f6385H;

    /* renamed from: I, reason: collision with root package name */
    public O[] f6386I;

    /* renamed from: J, reason: collision with root package name */
    public boolean f6387J;

    /* renamed from: a, reason: collision with root package name */
    public final s.a f6388a;

    /* renamed from: b, reason: collision with root package name */
    public final int f6389b;

    /* renamed from: c, reason: collision with root package name */
    public final s f6390c;

    /* renamed from: d, reason: collision with root package name */
    public final List f6391d;

    /* renamed from: e, reason: collision with root package name */
    public final SparseArray f6392e;

    /* renamed from: f, reason: collision with root package name */
    public final C1144z f6393f;

    /* renamed from: g, reason: collision with root package name */
    public final C1144z f6394g;

    /* renamed from: h, reason: collision with root package name */
    public final C1144z f6395h;

    /* renamed from: i, reason: collision with root package name */
    public final byte[] f6396i;

    /* renamed from: j, reason: collision with root package name */
    public final C1144z f6397j;

    /* renamed from: k, reason: collision with root package name */
    public final C1111E f6398k;

    /* renamed from: l, reason: collision with root package name */
    public final P1.c f6399l;

    /* renamed from: m, reason: collision with root package name */
    public final C1144z f6400m;

    /* renamed from: n, reason: collision with root package name */
    public final ArrayDeque f6401n;

    /* renamed from: o, reason: collision with root package name */
    public final ArrayDeque f6402o;

    /* renamed from: p, reason: collision with root package name */
    public final O f6403p;

    /* renamed from: q, reason: collision with root package name */
    public z6.w f6404q;

    /* renamed from: r, reason: collision with root package name */
    public int f6405r;

    /* renamed from: s, reason: collision with root package name */
    public int f6406s;

    /* renamed from: t, reason: collision with root package name */
    public long f6407t;

    /* renamed from: u, reason: collision with root package name */
    public int f6408u;

    /* renamed from: v, reason: collision with root package name */
    public C1144z f6409v;

    /* renamed from: w, reason: collision with root package name */
    public long f6410w;

    /* renamed from: x, reason: collision with root package name */
    public int f6411x;

    /* renamed from: y, reason: collision with root package name */
    public long f6412y;

    /* renamed from: z, reason: collision with root package name */
    public long f6413z;

    /* loaded from: /home/brian-terer/Downloads/BitePal/main_apk/classes.dex */
    public static final class a {

        /* renamed from: a, reason: collision with root package name */
        public final long f6414a;

        /* renamed from: b, reason: collision with root package name */
        public final boolean f6415b;

        /* renamed from: c, reason: collision with root package name */
        public final int f6416c;

        public a(long j6, boolean z6, int i6) {
            this.f6414a = j6;
            this.f6415b = z6;
            this.f6416c = i6;
        }
    }

    /* loaded from: /home/brian-terer/Downloads/BitePal/main_apk/classes.dex */
    public static final class b {

        /* renamed from: a, reason: collision with root package name */
        public final O f6417a;

        /* renamed from: d, reason: collision with root package name */
        public v f6420d;

        /* renamed from: e, reason: collision with root package name */
        public d f6421e;

        /* renamed from: f, reason: collision with root package name */
        public int f6422f;

        /* renamed from: g, reason: collision with root package name */
        public int f6423g;

        /* renamed from: h, reason: collision with root package name */
        public int f6424h;

        /* renamed from: i, reason: collision with root package name */
        public int f6425i;

        /* renamed from: l, reason: collision with root package name */
        public boolean f6428l;

        /* renamed from: b, reason: collision with root package name */
        public final u f6418b = new u();

        /* renamed from: c, reason: collision with root package name */
        public final C1144z f6419c = new C1144z();

        /* renamed from: j, reason: collision with root package name */
        public final C1144z f6426j = new C1144z(1);

        /* renamed from: k, reason: collision with root package name */
        public final C1144z f6427k = new C1144z();

        public b(O o6, v vVar, d dVar) {
            this.f6417a = o6;
            this.f6420d = vVar;
            this.f6421e = dVar;
            j(vVar, dVar);
        }

        public int c() {
            int i6 = !this.f6428l ? this.f6420d.f6519g[this.f6422f] : this.f6418b.f6505k[this.f6422f] ? 1 : 0;
            return g() != null ? i6 | 1073741824 : i6;
        }

        public long d() {
            return !this.f6428l ? this.f6420d.f6515c[this.f6422f] : this.f6418b.f6501g[this.f6424h];
        }

        public long e() {
            return !this.f6428l ? this.f6420d.f6518f[this.f6422f] : this.f6418b.c(this.f6422f);
        }

        public int f() {
            return !this.f6428l ? this.f6420d.f6516d[this.f6422f] : this.f6418b.f6503i[this.f6422f];
        }

        public t g() {
            if (!this.f6428l) {
                return null;
            }
            int i6 = ((d) AbstractC1117K.i(this.f6418b.f6495a)).f6364a;
            t tVar = this.f6418b.f6508n;
            if (tVar == null) {
                tVar = this.f6420d.f6513a.a(i6);
            }
            if (tVar == null || !tVar.f6490a) {
                return null;
            }
            return tVar;
        }

        public boolean h() {
            this.f6422f++;
            if (!this.f6428l) {
                return false;
            }
            int i6 = this.f6423g + 1;
            this.f6423g = i6;
            int[] iArr = this.f6418b.f6502h;
            int i7 = this.f6424h;
            if (i6 != iArr[i7]) {
                return true;
            }
            this.f6424h = i7 + 1;
            this.f6423g = 0;
            return false;
        }

        public int i(int i6, int i7) {
            C1144z c1144z;
            t g6 = g();
            if (g6 == null) {
                return 0;
            }
            int i8 = g6.f6493d;
            if (i8 != 0) {
                c1144z = this.f6418b.f6509o;
            } else {
                byte[] bArr = (byte[]) AbstractC1117K.i(g6.f6494e);
                this.f6427k.R(bArr, bArr.length);
                C1144z c1144z2 = this.f6427k;
                i8 = bArr.length;
                c1144z = c1144z2;
            }
            boolean g7 = this.f6418b.g(this.f6422f);
            boolean z6 = g7 || i7 != 0;
            this.f6426j.e()[0] = (byte) ((z6 ? 128 : 0) | i8);
            this.f6426j.T(0);
            this.f6417a.b(this.f6426j, 1, 1);
            this.f6417a.b(c1144z, i8, 1);
            if (!z6) {
                return i8 + 1;
            }
            if (!g7) {
                this.f6419c.P(8);
                byte[] e6 = this.f6419c.e();
                e6[0] = 0;
                e6[1] = 1;
                e6[2] = (byte) ((i7 >> 8) & 255);
                e6[3] = (byte) (i7 & 255);
                e6[4] = (byte) ((i6 >> 24) & 255);
                e6[5] = (byte) ((i6 >> 16) & 255);
                e6[6] = (byte) ((i6 >> 8) & 255);
                e6[7] = (byte) (i6 & 255);
                this.f6417a.b(this.f6419c, 8, 1);
                return i8 + 9;
            }
            C1144z c1144z3 = this.f6418b.f6509o;
            int M5 = c1144z3.M();
            c1144z3.U(-2);
            int i9 = (M5 * 6) + 2;
            if (i7 != 0) {
                this.f6419c.P(i9);
                byte[] e7 = this.f6419c.e();
                c1144z3.l(e7, 0, i9);
                int i10 = (((e7[2] & 255) << 8) | (e7[3] & 255)) + i7;
                e7[2] = (byte) ((i10 >> 8) & 255);
                e7[3] = (byte) (i10 & 255);
                c1144z3 = this.f6419c;
            }
            this.f6417a.b(c1144z3, i9, 1);
            return i8 + 1 + i9;
        }

        public void j(v vVar, d dVar) {
            this.f6420d = vVar;
            this.f6421e = dVar;
            this.f6417a.e(vVar.f6513a.f6484f);
            k();
        }

        public void k() {
            this.f6418b.f();
            this.f6422f = 0;
            this.f6424h = 0;
            this.f6423g = 0;
            this.f6425i = 0;
            this.f6428l = false;
        }

        public void l(long j6) {
            int i6 = this.f6422f;
            while (true) {
                u uVar = this.f6418b;
                if (i6 >= uVar.f6500f || uVar.c(i6) > j6) {
                    return;
                }
                if (this.f6418b.f6505k[i6]) {
                    this.f6425i = i6;
                }
                i6++;
            }
        }

        public void m() {
            t g6 = g();
            if (g6 == null) {
                return;
            }
            C1144z c1144z = this.f6418b.f6509o;
            int i6 = g6.f6493d;
            if (i6 != 0) {
                c1144z.U(i6);
            }
            if (this.f6418b.g(this.f6422f)) {
                c1144z.U(c1144z.M() * 6);
            }
        }

        public void n(C0841m c0841m) {
            t a6 = this.f6420d.f6513a.a(((d) AbstractC1117K.i(this.f6418b.f6495a)).f6364a);
            this.f6417a.e(this.f6420d.f6513a.f6484f.a().U(c0841m.d(a6 != null ? a6.f6491b : null)).K());
        }
    }

    public h(s.a aVar, int i6) {
        this(aVar, i6, null, null, z6.w.w(), null);
    }

    public static void A(a.C0109a c0109a, String str, u uVar) {
        byte[] bArr = null;
        C1144z c1144z = null;
        C1144z c1144z2 = null;
        for (int i6 = 0; i6 < c0109a.f6329c.size(); i6++) {
            a.b bVar = (a.b) c0109a.f6329c.get(i6);
            C1144z c1144z3 = bVar.f6331b;
            int i7 = bVar.f6327a;
            if (i7 == 1935828848) {
                c1144z3.T(12);
                if (c1144z3.p() == 1936025959) {
                    c1144z = c1144z3;
                }
            } else if (i7 == 1936158820) {
                c1144z3.T(12);
                if (c1144z3.p() == 1936025959) {
                    c1144z2 = c1144z3;
                }
            }
        }
        if (c1144z == null || c1144z2 == null) {
            return;
        }
        c1144z.T(8);
        int c6 = Y1.a.c(c1144z.p());
        c1144z.U(4);
        if (c6 == 1) {
            c1144z.U(4);
        }
        if (c1144z.p() != 1) {
            throw z.e("Entry count in sbgp != 1 (unsupported).");
        }
        c1144z2.T(8);
        int c7 = Y1.a.c(c1144z2.p());
        c1144z2.U(4);
        if (c7 == 1) {
            if (c1144z2.I() == 0) {
                throw z.e("Variable length description in sgpd found (unsupported)");
            }
        } else if (c7 >= 2) {
            c1144z2.U(4);
        }
        if (c1144z2.I() != 1) {
            throw z.e("Entry count in sgpd != 1 (unsupported).");
        }
        c1144z2.U(1);
        int G6 = c1144z2.G();
        int i8 = (G6 & 240) >> 4;
        int i9 = G6 & 15;
        boolean z6 = c1144z2.G() == 1;
        if (z6) {
            int G7 = c1144z2.G();
            byte[] bArr2 = new byte[16];
            c1144z2.l(bArr2, 0, 16);
            if (G7 == 0) {
                int G8 = c1144z2.G();
                bArr = new byte[G8];
                c1144z2.l(bArr, 0, G8);
            }
            uVar.f6506l = true;
            uVar.f6508n = new t(z6, str, G7, bArr2, i8, i9, bArr);
        }
    }

    public static void B(C1144z c1144z, int i6, u uVar) {
        c1144z.T(i6 + 8);
        int b6 = Y1.a.b(c1144z.p());
        if ((b6 & 1) != 0) {
            throw z.e("Overriding TrackEncryptionBox parameters is unsupported.");
        }
        boolean z6 = (b6 & 2) != 0;
        int K5 = c1144z.K();
        if (K5 == 0) {
            Arrays.fill(uVar.f6507m, 0, uVar.f6500f, false);
            return;
        }
        if (K5 == uVar.f6500f) {
            Arrays.fill(uVar.f6507m, 0, K5, z6);
            uVar.d(c1144z.a());
            uVar.b(c1144z);
        } else {
            throw z.a("Senc sample count " + K5 + " is different from fragment sample count" + uVar.f6500f, null);
        }
    }

    public static void C(C1144z c1144z, u uVar) {
        B(c1144z, 0, uVar);
    }

    public static Pair D(C1144z c1144z, long j6) {
        long L5;
        long L6;
        c1144z.T(8);
        int c6 = Y1.a.c(c1144z.p());
        c1144z.U(4);
        long I6 = c1144z.I();
        if (c6 == 0) {
            L5 = c1144z.I();
            L6 = c1144z.I();
        } else {
            L5 = c1144z.L();
            L6 = c1144z.L();
        }
        long j7 = j6 + L6;
        long W02 = AbstractC1117K.W0(L5, 1000000L, I6);
        c1144z.U(2);
        int M5 = c1144z.M();
        int[] iArr = new int[M5];
        long[] jArr = new long[M5];
        long[] jArr2 = new long[M5];
        long[] jArr3 = new long[M5];
        long j8 = j7;
        long j9 = W02;
        int i6 = 0;
        while (i6 < M5) {
            int p6 = c1144z.p();
            if ((Integer.MIN_VALUE & p6) != 0) {
                throw z.a("Unhandled indirect reference", null);
            }
            long I7 = c1144z.I();
            iArr[i6] = p6 & IntCompanionObject.MAX_VALUE;
            jArr[i6] = j8;
            jArr3[i6] = j9;
            L5 += I7;
            long[] jArr4 = jArr3;
            j9 = AbstractC1117K.W0(L5, 1000000L, I6);
            jArr2[i6] = j9 - jArr4[i6];
            c1144z.U(4);
            j8 += iArr[i6];
            i6++;
            jArr3 = jArr4;
        }
        return Pair.create(Long.valueOf(W02), new C0305g(iArr, jArr, jArr2, jArr3));
    }

    public static long E(C1144z c1144z) {
        c1144z.T(8);
        return Y1.a.c(c1144z.p()) == 1 ? c1144z.L() : c1144z.I();
    }

    public static b F(C1144z c1144z, SparseArray sparseArray, boolean z6) {
        c1144z.T(8);
        int b6 = Y1.a.b(c1144z.p());
        b bVar = (b) (z6 ? sparseArray.valueAt(0) : sparseArray.get(c1144z.p()));
        if (bVar == null) {
            return null;
        }
        if ((b6 & 1) != 0) {
            long L5 = c1144z.L();
            u uVar = bVar.f6418b;
            uVar.f6497c = L5;
            uVar.f6498d = L5;
        }
        d dVar = bVar.f6421e;
        bVar.f6418b.f6495a = new d((b6 & 2) != 0 ? c1144z.p() - 1 : dVar.f6364a, (b6 & 8) != 0 ? c1144z.p() : dVar.f6365b, (b6 & 16) != 0 ? c1144z.p() : dVar.f6366c, (b6 & 32) != 0 ? c1144z.p() : dVar.f6367d);
        return bVar;
    }

    public static void G(a.C0109a c0109a, SparseArray sparseArray, boolean z6, int i6, byte[] bArr) {
        b F6 = F(((a.b) AbstractC1119a.e(c0109a.g(1952868452))).f6331b, sparseArray, z6);
        if (F6 == null) {
            return;
        }
        u uVar = F6.f6418b;
        long j6 = uVar.f6511q;
        boolean z7 = uVar.f6512r;
        F6.k();
        F6.f6428l = true;
        a.b g6 = c0109a.g(1952867444);
        if (g6 == null || (i6 & 2) != 0) {
            uVar.f6511q = j6;
            uVar.f6512r = z7;
        } else {
            uVar.f6511q = E(g6.f6331b);
            uVar.f6512r = true;
        }
        J(c0109a, F6, i6);
        t a6 = F6.f6420d.f6513a.a(((d) AbstractC1119a.e(uVar.f6495a)).f6364a);
        a.b g7 = c0109a.g(1935763834);
        if (g7 != null) {
            z((t) AbstractC1119a.e(a6), g7.f6331b, uVar);
        }
        a.b g8 = c0109a.g(1935763823);
        if (g8 != null) {
            y(g8.f6331b, uVar);
        }
        a.b g9 = c0109a.g(1936027235);
        if (g9 != null) {
            C(g9.f6331b, uVar);
        }
        A(c0109a, a6 != null ? a6.f6491b : null, uVar);
        int size = c0109a.f6329c.size();
        for (int i7 = 0; i7 < size; i7++) {
            a.b bVar = (a.b) c0109a.f6329c.get(i7);
            if (bVar.f6327a == 1970628964) {
                K(bVar.f6331b, uVar, bArr);
            }
        }
    }

    public static Pair H(C1144z c1144z) {
        c1144z.T(12);
        return Pair.create(Integer.valueOf(c1144z.p()), new d(c1144z.p() - 1, c1144z.p(), c1144z.p(), c1144z.p()));
    }

    public static int I(b bVar, int i6, int i7, C1144z c1144z, int i8) {
        boolean z6;
        int i9;
        int i10;
        int i11;
        int i12;
        int i13;
        int i14;
        int i15;
        c1144z.T(8);
        int b6 = Y1.a.b(c1144z.p());
        s sVar = bVar.f6420d.f6513a;
        u uVar = bVar.f6418b;
        d dVar = (d) AbstractC1117K.i(uVar.f6495a);
        uVar.f6502h[i6] = c1144z.K();
        long[] jArr = uVar.f6501g;
        long j6 = uVar.f6497c;
        jArr[i6] = j6;
        if ((b6 & 1) != 0) {
            jArr[i6] = j6 + c1144z.p();
        }
        boolean z7 = (b6 & 4) != 0;
        int i16 = dVar.f6367d;
        if (z7) {
            i16 = c1144z.p();
        }
        boolean z8 = (b6 & 256) != 0;
        boolean z9 = (b6 & ConstantsKt.MINIMUM_BLOCK_SIZE) != 0;
        boolean z10 = (b6 & 1024) != 0;
        boolean z11 = (b6 & 2048) != 0;
        long j7 = o(sVar) ? ((long[]) AbstractC1117K.i(sVar.f6487i))[0] : 0L;
        int[] iArr = uVar.f6503i;
        long[] jArr2 = uVar.f6504j;
        boolean[] zArr = uVar.f6505k;
        boolean z12 = z11;
        boolean z13 = sVar.f6480b == 2 && (i7 & 1) != 0;
        int i17 = i8 + uVar.f6502h[i6];
        boolean z14 = z7;
        long j8 = sVar.f6481c;
        long j9 = uVar.f6511q;
        int i18 = i8;
        while (i18 < i17) {
            if (z8) {
                i9 = c1144z.p();
                z6 = z13;
            } else {
                z6 = z13;
                i9 = dVar.f6365b;
            }
            int e6 = e(i9);
            if (z9) {
                i11 = c1144z.p();
                i10 = i17;
            } else {
                i10 = i17;
                i11 = dVar.f6366c;
            }
            int e7 = e(i11);
            if (z10) {
                i12 = e7;
                i13 = c1144z.p();
            } else if (i18 == 0 && z14) {
                i12 = e7;
                i13 = i16;
            } else {
                i12 = e7;
                i13 = dVar.f6367d;
            }
            if (z12) {
                i14 = i13;
                i15 = c1144z.p();
            } else {
                i14 = i13;
                i15 = 0;
            }
            int i19 = i18;
            long W02 = AbstractC1117K.W0((i15 + j9) - j7, 1000000L, j8);
            jArr2[i19] = W02;
            if (!uVar.f6512r) {
                jArr2[i19] = W02 + bVar.f6420d.f6520h;
            }
            iArr[i19] = i12;
            zArr[i19] = ((i14 >> 16) & 1) == 0 && (!z6 || i19 == 0);
            j9 += e6;
            i18 = i19 + 1;
            i17 = i10;
            z13 = z6;
        }
        int i20 = i17;
        uVar.f6511q = j9;
        return i20;
    }

    public static void J(a.C0109a c0109a, b bVar, int i6) {
        List list = c0109a.f6329c;
        int size = list.size();
        int i7 = 0;
        int i8 = 0;
        for (int i9 = 0; i9 < size; i9++) {
            a.b bVar2 = (a.b) list.get(i9);
            if (bVar2.f6327a == 1953658222) {
                C1144z c1144z = bVar2.f6331b;
                c1144z.T(12);
                int K5 = c1144z.K();
                if (K5 > 0) {
                    i8 += K5;
                    i7++;
                }
            }
        }
        bVar.f6424h = 0;
        bVar.f6423g = 0;
        bVar.f6422f = 0;
        bVar.f6418b.e(i7, i8);
        int i10 = 0;
        int i11 = 0;
        for (int i12 = 0; i12 < size; i12++) {
            a.b bVar3 = (a.b) list.get(i12);
            if (bVar3.f6327a == 1953658222) {
                i11 = I(bVar, i10, i6, bVar3.f6331b, i11);
                i10++;
            }
        }
    }

    public static void K(C1144z c1144z, u uVar, byte[] bArr) {
        c1144z.T(8);
        c1144z.l(bArr, 0, 16);
        if (Arrays.equals(bArr, f6376L)) {
            B(c1144z, 16, uVar);
        }
    }

    private void L(long j6) {
        while (!this.f6401n.isEmpty() && ((a.C0109a) this.f6401n.peek()).f6328b == j6) {
            q((a.C0109a) this.f6401n.pop());
        }
        f();
    }

    private boolean M(InterfaceC0315q interfaceC0315q) {
        if (this.f6408u == 0) {
            if (!interfaceC0315q.c(this.f6400m.e(), 0, 8, true)) {
                return false;
            }
            this.f6408u = 8;
            this.f6400m.T(0);
            this.f6407t = this.f6400m.I();
            this.f6406s = this.f6400m.p();
        }
        long j6 = this.f6407t;
        if (j6 == 1) {
            interfaceC0315q.readFully(this.f6400m.e(), 8, 8);
            this.f6408u += 8;
            this.f6407t = this.f6400m.L();
        } else if (j6 == 0) {
            long a6 = interfaceC0315q.a();
            if (a6 == -1 && !this.f6401n.isEmpty()) {
                a6 = ((a.C0109a) this.f6401n.peek()).f6328b;
            }
            if (a6 != -1) {
                this.f6407t = (a6 - interfaceC0315q.getPosition()) + this.f6408u;
            }
        }
        if (this.f6407t < this.f6408u) {
            throw z.e("Atom size less than header length (unsupported).");
        }
        long position = interfaceC0315q.getPosition() - this.f6408u;
        int i6 = this.f6406s;
        if ((i6 == 1836019558 || i6 == 1835295092) && !this.f6387J) {
            this.f6384G.n(new J.b(this.f6413z, position));
            this.f6387J = true;
        }
        if (this.f6406s == 1836019558) {
            int size = this.f6392e.size();
            for (int i7 = 0; i7 < size; i7++) {
                u uVar = ((b) this.f6392e.valueAt(i7)).f6418b;
                uVar.f6496b = position;
                uVar.f6498d = position;
                uVar.f6497c = position;
            }
        }
        int i8 = this.f6406s;
        if (i8 == 1835295092) {
            this.f6379B = null;
            this.f6410w = position + this.f6407t;
            this.f6405r = 2;
            return true;
        }
        if (Q(i8)) {
            long position2 = (interfaceC0315q.getPosition() + this.f6407t) - 8;
            this.f6401n.push(new a.C0109a(this.f6406s, position2));
            if (this.f6407t == this.f6408u) {
                L(position2);
            } else {
                f();
            }
        } else if (R(this.f6406s)) {
            if (this.f6408u != 8) {
                throw z.e("Leaf atom defines extended atom size (unsupported).");
            }
            if (this.f6407t > 2147483647L) {
                throw z.e("Leaf atom with length > 2147483647 (unsupported).");
            }
            C1144z c1144z = new C1144z((int) this.f6407t);
            System.arraycopy(this.f6400m.e(), 0, c1144z.e(), 0, 8);
            this.f6409v = c1144z;
            this.f6405r = 1;
        } else {
            if (this.f6407t > 2147483647L) {
                throw z.e("Skipping atom with length > 2147483647 (unsupported).");
            }
            this.f6409v = null;
            this.f6405r = 1;
        }
        return true;
    }

    private static boolean Q(int i6) {
        return i6 == 1836019574 || i6 == 1953653099 || i6 == 1835297121 || i6 == 1835626086 || i6 == 1937007212 || i6 == 1836019558 || i6 == 1953653094 || i6 == 1836475768 || i6 == 1701082227;
    }

    private static boolean R(int i6) {
        return i6 == 1751411826 || i6 == 1835296868 || i6 == 1836476516 || i6 == 1936286840 || i6 == 1937011556 || i6 == 1937011827 || i6 == 1668576371 || i6 == 1937011555 || i6 == 1937011578 || i6 == 1937013298 || i6 == 1937007471 || i6 == 1668232756 || i6 == 1937011571 || i6 == 1952867444 || i6 == 1952868452 || i6 == 1953196132 || i6 == 1953654136 || i6 == 1953658222 || i6 == 1886614376 || i6 == 1935763834 || i6 == 1935763823 || i6 == 1936027235 || i6 == 1970628964 || i6 == 1935828848 || i6 == 1936158820 || i6 == 1701606260 || i6 == 1835362404 || i6 == 1701671783;
    }

    public static /* synthetic */ InterfaceC0314p[] b() {
        return new InterfaceC0314p[]{new h(s.a.f10491a, 32)};
    }

    public static int e(int i6) {
        if (i6 >= 0) {
            return i6;
        }
        throw z.a("Unexpected negative value: " + i6, null);
    }

    private void f() {
        this.f6405r = 0;
        this.f6408u = 0;
    }

    public static C0841m k(List list) {
        int size = list.size();
        ArrayList arrayList = null;
        for (int i6 = 0; i6 < size; i6++) {
            a.b bVar = (a.b) list.get(i6);
            if (bVar.f6327a == 1886614376) {
                if (arrayList == null) {
                    arrayList = new ArrayList();
                }
                byte[] e6 = bVar.f6331b.e();
                UUID f6 = o.f(e6);
                if (f6 == null) {
                    AbstractC1133o.h("FragmentedMp4Extractor", "Skipped pssh atom (failed to extract uuid)");
                } else {
                    arrayList.add(new C0841m.b(f6, "video/mp4", e6));
                }
            }
        }
        if (arrayList == null) {
            return null;
        }
        return new C0841m(arrayList);
    }

    public static b l(SparseArray sparseArray) {
        int size = sparseArray.size();
        b bVar = null;
        long j6 = LongCompanionObject.MAX_VALUE;
        for (int i6 = 0; i6 < size; i6++) {
            b bVar2 = (b) sparseArray.valueAt(i6);
            if ((bVar2.f6428l || bVar2.f6422f != bVar2.f6420d.f6514b) && (!bVar2.f6428l || bVar2.f6424h != bVar2.f6418b.f6499e)) {
                long d6 = bVar2.d();
                if (d6 < j6) {
                    bVar = bVar2;
                    j6 = d6;
                }
            }
        }
        return bVar;
    }

    public static boolean o(s sVar) {
        long[] jArr;
        long[] jArr2 = sVar.f6486h;
        if (jArr2 != null && jArr2.length == 1 && (jArr = sVar.f6487i) != null) {
            long j6 = jArr2[0];
            if (j6 == 0 || AbstractC1117K.W0(j6 + jArr[0], 1000000L, sVar.f6482d) >= sVar.f6483e) {
                return true;
            }
        }
        return false;
    }

    public static long w(C1144z c1144z) {
        c1144z.T(8);
        return Y1.a.c(c1144z.p()) == 0 ? c1144z.I() : c1144z.L();
    }

    public static void x(a.C0109a c0109a, SparseArray sparseArray, boolean z6, int i6, byte[] bArr) {
        int size = c0109a.f6330d.size();
        for (int i7 = 0; i7 < size; i7++) {
            a.C0109a c0109a2 = (a.C0109a) c0109a.f6330d.get(i7);
            if (c0109a2.f6327a == 1953653094) {
                G(c0109a2, sparseArray, z6, i6, bArr);
            }
        }
    }

    public static void y(C1144z c1144z, u uVar) {
        c1144z.T(8);
        int p6 = c1144z.p();
        if ((Y1.a.b(p6) & 1) == 1) {
            c1144z.U(8);
        }
        int K5 = c1144z.K();
        if (K5 == 1) {
            uVar.f6498d += Y1.a.c(p6) == 0 ? c1144z.I() : c1144z.L();
        } else {
            throw z.a("Unexpected saio entry count: " + K5, null);
        }
    }

    public static void z(t tVar, C1144z c1144z, u uVar) {
        int i6;
        int i7 = tVar.f6493d;
        c1144z.T(8);
        if ((Y1.a.b(c1144z.p()) & 1) == 1) {
            c1144z.U(8);
        }
        int G6 = c1144z.G();
        int K5 = c1144z.K();
        if (K5 > uVar.f6500f) {
            throw z.a("Saiz sample count " + K5 + " is greater than fragment sample count" + uVar.f6500f, null);
        }
        if (G6 == 0) {
            boolean[] zArr = uVar.f6507m;
            i6 = 0;
            for (int i8 = 0; i8 < K5; i8++) {
                int G7 = c1144z.G();
                i6 += G7;
                zArr[i8] = G7 > i7;
            }
        } else {
            i6 = G6 * K5;
            Arrays.fill(uVar.f6507m, 0, K5, G6 > i7);
        }
        Arrays.fill(uVar.f6507m, K5, uVar.f6500f, false);
        if (i6 > 0) {
            uVar.d(i6);
        }
    }

    public final void N(InterfaceC0315q interfaceC0315q) {
        int i6 = ((int) this.f6407t) - this.f6408u;
        C1144z c1144z = this.f6409v;
        if (c1144z != null) {
            interfaceC0315q.readFully(c1144z.e(), 8, i6);
            s(new a.b(this.f6406s, c1144z), interfaceC0315q.getPosition());
        } else {
            interfaceC0315q.p(i6);
        }
        L(interfaceC0315q.getPosition());
    }

    public final void O(InterfaceC0315q interfaceC0315q) {
        int size = this.f6392e.size();
        long j6 = LongCompanionObject.MAX_VALUE;
        b bVar = null;
        for (int i6 = 0; i6 < size; i6++) {
            u uVar = ((b) this.f6392e.valueAt(i6)).f6418b;
            if (uVar.f6510p) {
                long j7 = uVar.f6498d;
                if (j7 < j6) {
                    bVar = (b) this.f6392e.valueAt(i6);
                    j6 = j7;
                }
            }
        }
        if (bVar == null) {
            this.f6405r = 3;
            return;
        }
        int position = (int) (j6 - interfaceC0315q.getPosition());
        if (position < 0) {
            throw z.a("Offset to encryption data was negative.", null);
        }
        interfaceC0315q.p(position);
        bVar.f6418b.a(interfaceC0315q);
    }

    /* JADX WARN: Multi-variable type inference failed */
    public final boolean P(InterfaceC0315q interfaceC0315q) {
        boolean z6;
        int i6;
        int c6;
        b bVar = this.f6379B;
        Throwable th = null;
        if (bVar == null) {
            bVar = l(this.f6392e);
            if (bVar == null) {
                int position = (int) (this.f6410w - interfaceC0315q.getPosition());
                if (position < 0) {
                    throw z.a("Offset to end of mdat was negative.", null);
                }
                interfaceC0315q.p(position);
                f();
                return false;
            }
            int d6 = (int) (bVar.d() - interfaceC0315q.getPosition());
            if (d6 < 0) {
                AbstractC1133o.h("FragmentedMp4Extractor", "Ignoring negative offset to sample data.");
                d6 = 0;
            }
            interfaceC0315q.p(d6);
            this.f6379B = bVar;
        }
        int i7 = 4;
        int i8 = 1;
        if (this.f6405r == 3) {
            int f6 = bVar.f();
            this.f6380C = f6;
            if (bVar.f6422f < bVar.f6425i) {
                interfaceC0315q.p(f6);
                bVar.m();
                if (!bVar.h()) {
                    this.f6379B = null;
                }
                this.f6405r = 3;
                return true;
            }
            if (bVar.f6420d.f6513a.f6485g == 1) {
                this.f6380C = f6 - 8;
                interfaceC0315q.p(8);
            }
            if ("audio/ac4".equals(bVar.f6420d.f6513a.f6484f.f6990n)) {
                this.f6381D = bVar.i(this.f6380C, 7);
                AbstractC0301c.a(this.f6380C, this.f6397j);
                bVar.f6417a.a(this.f6397j, 7);
                this.f6381D += 7;
            } else {
                this.f6381D = bVar.i(this.f6380C, 0);
            }
            this.f6380C += this.f6381D;
            this.f6405r = 4;
            this.f6382E = 0;
        }
        s sVar = bVar.f6420d.f6513a;
        O o6 = bVar.f6417a;
        long e6 = bVar.e();
        C1111E c1111e = this.f6398k;
        if (c1111e != null) {
            e6 = c1111e.a(e6);
        }
        if (sVar.f6488j == 0) {
            z6 = 1;
            while (true) {
                int i9 = this.f6381D;
                int i10 = this.f6380C;
                if (i9 >= i10) {
                    break;
                }
                this.f6381D += o6.c(interfaceC0315q, i10 - i9, false);
            }
        } else {
            byte[] e7 = this.f6394g.e();
            e7[0] = 0;
            e7[1] = 0;
            e7[2] = 0;
            int i11 = sVar.f6488j;
            int i12 = i11 + 1;
            int i13 = 4 - i11;
            while (this.f6381D < this.f6380C) {
                int i14 = this.f6382E;
                if (i14 == 0) {
                    interfaceC0315q.readFully(e7, i13, i12);
                    this.f6394g.T(0);
                    int p6 = this.f6394g.p();
                    if (p6 < i8) {
                        throw z.a("Invalid NAL length", th);
                    }
                    this.f6382E = p6 - 1;
                    this.f6393f.T(0);
                    o6.a(this.f6393f, i7);
                    o6.a(this.f6394g, i8);
                    this.f6383F = (this.f6386I.length <= 0 || !d1.d.g(sVar.f6484f.f6990n, e7[i7])) ? 0 : i8;
                    this.f6381D += 5;
                    this.f6380C += i13;
                } else {
                    if (this.f6383F) {
                        this.f6395h.P(i14);
                        interfaceC0315q.readFully(this.f6395h.e(), 0, this.f6382E);
                        o6.a(this.f6395h, this.f6382E);
                        c6 = this.f6382E;
                        int r6 = d1.d.r(this.f6395h.e(), this.f6395h.g());
                        i6 = i8;
                        this.f6395h.T("video/hevc".equals(sVar.f6484f.f6990n) ? 1 : 0);
                        this.f6395h.S(r6);
                        AbstractC0304f.a(e6, this.f6395h, this.f6386I);
                    } else {
                        i6 = i8;
                        c6 = o6.c(interfaceC0315q, i14, false);
                    }
                    this.f6381D += c6;
                    this.f6382E -= c6;
                    i8 = i6;
                    th = null;
                    i7 = 4;
                }
            }
            z6 = i8;
        }
        int c7 = bVar.c();
        t g6 = bVar.g();
        o6.f(e6, c7, this.f6380C, 0, g6 != null ? g6.f6492c : null);
        v(e6);
        if (!bVar.h()) {
            this.f6379B = null;
        }
        this.f6405r = 3;
        return z6;
    }

    @Override // E1.InterfaceC0314p
    public void a(long j6, long j7) {
        int size = this.f6392e.size();
        for (int i6 = 0; i6 < size; i6++) {
            ((b) this.f6392e.valueAt(i6)).k();
        }
        this.f6402o.clear();
        this.f6411x = 0;
        this.f6412y = j7;
        this.f6401n.clear();
        f();
    }

    @Override // E1.InterfaceC0314p
    public void c(E1.r rVar) {
        this.f6384G = (this.f6389b & 32) == 0 ? new b2.u(rVar, this.f6388a) : rVar;
        f();
        n();
        s sVar = this.f6390c;
        if (sVar != null) {
            this.f6392e.put(0, new b(rVar.a(0, sVar.f6480b), new v(this.f6390c, new long[0], new int[0], 0, new long[0], new int[0], 0L), new d(0, 0, 0, 0)));
            this.f6384G.k();
        }
    }

    @Override // E1.InterfaceC0314p
    public int g(InterfaceC0315q interfaceC0315q, I i6) {
        while (true) {
            int i7 = this.f6405r;
            if (i7 != 0) {
                if (i7 == 1) {
                    N(interfaceC0315q);
                } else if (i7 == 2) {
                    O(interfaceC0315q);
                } else if (P(interfaceC0315q)) {
                    return 0;
                }
            } else if (!M(interfaceC0315q)) {
                return -1;
            }
        }
    }

    @Override // E1.InterfaceC0314p
    public boolean i(InterfaceC0315q interfaceC0315q) {
        N b6 = r.b(interfaceC0315q);
        this.f6404q = b6 != null ? z6.w.y(b6) : z6.w.w();
        return b6 == null;
    }

    public final d j(SparseArray sparseArray, int i6) {
        return sparseArray.size() == 1 ? (d) sparseArray.valueAt(0) : (d) AbstractC1119a.e((d) sparseArray.get(i6));
    }

    @Override // E1.InterfaceC0314p
    /* renamed from: m, reason: merged with bridge method [inline-methods] */
    public z6.w h() {
        return this.f6404q;
    }

    public final void n() {
        int i6;
        O[] oArr = new O[2];
        this.f6385H = oArr;
        O o6 = this.f6403p;
        int i7 = 0;
        if (o6 != null) {
            oArr[0] = o6;
            i6 = 1;
        } else {
            i6 = 0;
        }
        int i8 = 100;
        if ((this.f6389b & 4) != 0) {
            oArr[i6] = this.f6384G.a(100, 5);
            i8 = 101;
            i6++;
        }
        O[] oArr2 = (O[]) AbstractC1117K.O0(this.f6385H, i6);
        this.f6385H = oArr2;
        for (O o7 : oArr2) {
            o7.e(f6377M);
        }
        this.f6386I = new O[this.f6391d.size()];
        while (i7 < this.f6386I.length) {
            O a6 = this.f6384G.a(i8, 3);
            a6.e((Z0.q) this.f6391d.get(i7));
            this.f6386I[i7] = a6;
            i7++;
            i8++;
        }
    }

    public s p(s sVar) {
        return sVar;
    }

    public final void q(a.C0109a c0109a) {
        int i6 = c0109a.f6327a;
        if (i6 == 1836019574) {
            u(c0109a);
        } else if (i6 == 1836019558) {
            t(c0109a);
        } else {
            if (this.f6401n.isEmpty()) {
                return;
            }
            ((a.C0109a) this.f6401n.peek()).d(c0109a);
        }
    }

    public final void r(C1144z c1144z) {
        String str;
        String str2;
        long W02;
        long W03;
        long I6;
        long j6;
        if (this.f6385H.length == 0) {
            return;
        }
        c1144z.T(8);
        int c6 = Y1.a.c(c1144z.p());
        if (c6 == 0) {
            str = (String) AbstractC1119a.e(c1144z.A());
            str2 = (String) AbstractC1119a.e(c1144z.A());
            long I7 = c1144z.I();
            W02 = AbstractC1117K.W0(c1144z.I(), 1000000L, I7);
            long j7 = this.f6378A;
            long j8 = j7 != -9223372036854775807L ? j7 + W02 : -9223372036854775807L;
            W03 = AbstractC1117K.W0(c1144z.I(), 1000L, I7);
            I6 = c1144z.I();
            j6 = j8;
        } else {
            if (c6 != 1) {
                AbstractC1133o.h("FragmentedMp4Extractor", "Skipping unsupported emsg version: " + c6);
                return;
            }
            long I8 = c1144z.I();
            j6 = AbstractC1117K.W0(c1144z.L(), 1000000L, I8);
            long W04 = AbstractC1117K.W0(c1144z.I(), 1000L, I8);
            long I9 = c1144z.I();
            str = (String) AbstractC1119a.e(c1144z.A());
            str2 = (String) AbstractC1119a.e(c1144z.A());
            W03 = W04;
            I6 = I9;
            W02 = -9223372036854775807L;
        }
        String str3 = str;
        String str4 = str2;
        byte[] bArr = new byte[c1144z.a()];
        c1144z.l(bArr, 0, c1144z.a());
        C1144z c1144z2 = new C1144z(this.f6399l.a(new P1.a(str3, str4, W03, I6, bArr)));
        int a6 = c1144z2.a();
        for (O o6 : this.f6385H) {
            c1144z2.T(0);
            o6.a(c1144z2, a6);
        }
        if (j6 == -9223372036854775807L) {
            this.f6402o.addLast(new a(W02, true, a6));
            this.f6411x += a6;
            return;
        }
        if (!this.f6402o.isEmpty()) {
            this.f6402o.addLast(new a(j6, false, a6));
            this.f6411x += a6;
            return;
        }
        C1111E c1111e = this.f6398k;
        if (c1111e != null && !c1111e.g()) {
            this.f6402o.addLast(new a(j6, false, a6));
            this.f6411x += a6;
            return;
        }
        C1111E c1111e2 = this.f6398k;
        if (c1111e2 != null) {
            j6 = c1111e2.a(j6);
        }
        long j9 = j6;
        for (O o7 : this.f6385H) {
            o7.f(j9, 1, a6, 0, null);
        }
    }

    @Override // E1.InterfaceC0314p
    public void release() {
    }

    public final void s(a.b bVar, long j6) {
        if (!this.f6401n.isEmpty()) {
            ((a.C0109a) this.f6401n.peek()).e(bVar);
            return;
        }
        int i6 = bVar.f6327a;
        if (i6 != 1936286840) {
            if (i6 == 1701671783) {
                r(bVar.f6331b);
            }
        } else {
            Pair D6 = D(bVar.f6331b, j6);
            this.f6378A = ((Long) D6.first).longValue();
            this.f6384G.n((J) D6.second);
            this.f6387J = true;
        }
    }

    public final void t(a.C0109a c0109a) {
        x(c0109a, this.f6392e, this.f6390c != null, this.f6389b, this.f6396i);
        C0841m k6 = k(c0109a.f6329c);
        if (k6 != null) {
            int size = this.f6392e.size();
            for (int i6 = 0; i6 < size; i6++) {
                ((b) this.f6392e.valueAt(i6)).n(k6);
            }
        }
        if (this.f6412y != -9223372036854775807L) {
            int size2 = this.f6392e.size();
            for (int i7 = 0; i7 < size2; i7++) {
                ((b) this.f6392e.valueAt(i7)).l(this.f6412y);
            }
            this.f6412y = -9223372036854775807L;
        }
    }

    public final void u(a.C0109a c0109a) {
        int i6 = 0;
        AbstractC1119a.h(this.f6390c == null, "Unexpected moov box.");
        C0841m k6 = k(c0109a.f6329c);
        a.C0109a c0109a2 = (a.C0109a) AbstractC1119a.e(c0109a.f(1836475768));
        SparseArray sparseArray = new SparseArray();
        int size = c0109a2.f6329c.size();
        long j6 = -9223372036854775807L;
        for (int i7 = 0; i7 < size; i7++) {
            a.b bVar = (a.b) c0109a2.f6329c.get(i7);
            int i8 = bVar.f6327a;
            if (i8 == 1953654136) {
                Pair H6 = H(bVar.f6331b);
                sparseArray.put(((Integer) H6.first).intValue(), (d) H6.second);
            } else if (i8 == 1835362404) {
                j6 = w(bVar.f6331b);
            }
        }
        List B6 = Y1.b.B(c0109a, new B(), j6, k6, (this.f6389b & 16) != 0, false, new y6.g() { // from class: Y1.g
            public final Object apply(Object obj) {
                return h.this.p((s) obj);
            }
        });
        int size2 = B6.size();
        if (this.f6392e.size() != 0) {
            AbstractC1119a.g(this.f6392e.size() == size2);
            while (i6 < size2) {
                v vVar = (v) B6.get(i6);
                s sVar = vVar.f6513a;
                ((b) this.f6392e.get(sVar.f6479a)).j(vVar, j(sparseArray, sVar.f6479a));
                i6++;
            }
            return;
        }
        while (i6 < size2) {
            v vVar2 = (v) B6.get(i6);
            s sVar2 = vVar2.f6513a;
            this.f6392e.put(sVar2.f6479a, new b(this.f6384G.a(i6, sVar2.f6480b), vVar2, j(sparseArray, sVar2.f6479a)));
            this.f6413z = Math.max(this.f6413z, sVar2.f6483e);
            i6++;
        }
        this.f6384G.k();
    }

    public final void v(long j6) {
        while (!this.f6402o.isEmpty()) {
            a aVar = (a) this.f6402o.removeFirst();
            this.f6411x -= aVar.f6416c;
            long j7 = aVar.f6414a;
            if (aVar.f6415b) {
                j7 += j6;
            }
            C1111E c1111e = this.f6398k;
            if (c1111e != null) {
                j7 = c1111e.a(j7);
            }
            long j8 = j7;
            for (O o6 : this.f6385H) {
                o6.f(j8, 1, aVar.f6416c, this.f6411x, null);
            }
        }
    }

    public h(s.a aVar, int i6, C1111E c1111e, s sVar, List list, O o6) {
        this.f6388a = aVar;
        this.f6389b = i6;
        this.f6398k = c1111e;
        this.f6390c = sVar;
        this.f6391d = Collections.unmodifiableList(list);
        this.f6403p = o6;
        this.f6399l = new P1.c();
        this.f6400m = new C1144z(16);
        this.f6393f = new C1144z(d1.d.f13379a);
        this.f6394g = new C1144z(5);
        this.f6395h = new C1144z();
        byte[] bArr = new byte[16];
        this.f6396i = bArr;
        this.f6397j = new C1144z(bArr);
        this.f6401n = new ArrayDeque();
        this.f6402o = new ArrayDeque();
        this.f6392e = new SparseArray();
        this.f6404q = z6.w.w();
        this.f6413z = -9223372036854775807L;
        this.f6412y = -9223372036854775807L;
        this.f6378A = -9223372036854775807L;
        this.f6384G = E1.r.f1079O;
        this.f6385H = new O[0];
        this.f6386I = new O[0];
    }
}
